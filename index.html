<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Daily Weather</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<style>
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%}
body{
  font-family:Inter,system-ui,"Segoe UI",Roboto,Arial;
  background:radial-gradient(1200px 800px at 10% 10%,#081129 0%,rgba(8,17,41,0) 25%),radial-gradient(800px 600px at 90% 90%,#0a1632 0%,rgba(10,22,50,0) 25%),#061226;
  color:#e6eef8;display:flex;flex-direction:column;min-height:100vh;padding:16px
}
.container{display:grid;grid-template-columns:1fr 420px 1fr;gap:32px;align-items:start;width:100%;max-width:1400px;margin:0 auto;padding:0 16px;flex:1}
.card{background:linear-gradient(180deg,rgba(255,255,255,0.04),rgba(255,255,255,0.02));border:1px solid rgba(255,255,255,0.06);border-radius:20px;padding:18px;box-shadow:0 8px 30px rgba(2,8,23,0.6);backdrop-filter:blur(6px) saturate(120%);transition:all .3s ease}
.left,.right{display:flex;flex-direction:column;gap:18px}
.large{height:auto;display:flex;flex-direction:column;justify-content:space-between;position:relative}
.large .top{display:flex;justify-content:space-between;align-items:flex-start}
.temp{font-size:72px;font-weight:700;color:#f4f8ff}
.subtitle{color:#bcd0ea;font-size:14px}
.meta-row{display:flex;gap:12px;margin-top:18px}
.meta-item{flex:1;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border-radius:12px;padding:10px;text-align:center;font-size:13px;color:#dbe9ff}
.forecast-container{margin-top:22px;display:flex;gap:10px;flex-wrap:wrap}
.forecast-card{flex:1 1 120px;min-width:110px;text-align:center;padding:10px;border-radius:12px;background:rgba(255,255,255,0.03)}
.forecast-card h4{font-size:14px;color:#bcd0ea;margin-bottom:6px}
.forecast-card span{display:block;font-size:13px;color:#f0f6ff}
.center{display:flex;align-items:center;justify-content:center}
.hero{width:380px;min-height:620px;border-radius:34px;background:linear-gradient(180deg,rgba(8,18,40,0.95),rgba(6,10,28,0.95));border:1px solid rgba(255,255,255,0.04);box-shadow:0 18px 60px rgba(3,8,25,0.7);padding:28px;display:flex;flex-direction:column;align-items:center;justify-content:space-between;transition:all .3s ease}
.hero .sky{width:220px;height:220px;border-radius:50%;background:radial-gradient(circle at 20% 10%,rgba(255,200,100,0.14),rgba(255,200,100,0.06) 10%,transparent 25%),rgba(255,255,255,0.02);display:flex;align-items:center;justify-content:center;box-shadow:inset 0 -8px 30px rgba(0,0,0,0.5)}
.hero .cloud{width:140px;height:100px;border-radius:70px;background:linear-gradient(180deg,#ffffff22,#ffffff11);display:flex;align-items:center;justify-content:center;position:relative;box-shadow:0 8px 20px rgba(0,0,0,0.6),0 1px 0 rgba(255,255,255,0.02) inset}
.drop{position:absolute;bottom:-14px;width:6px;height:12px;border-radius:6px;background:#7fc8ff;box-shadow:0 6px 18px rgba(127,200,255,0.12);animation:fall 1.2s infinite linear}
.drop:nth-child(1){left:34%;animation-delay:0s}
.drop:nth-child(2){left:50%;animation-delay:0.15s;animation-duration:1.1s}
.drop:nth-child(3){left:66%;animation-delay:0.25s;animation-duration:1.3s}
@keyframes fall{0%{transform:translateY(-2px);opacity:0}40%{opacity:1}100%{transform:translateY(22px);opacity:0}}

/* --- Search bar fix --- */
.search-row input{
  flex:1;
  padding:10px 14px;
  border:none;
  border-radius:10px;
  background:rgba(255,255,255,0.1);
  color:#fff;
  outline:none;
  font-size:14px;
  transition:all .2s ease;
}
.search-row input::placeholder{color:#c8d8ef}
.search-row input:focus{background:rgba(255,255,255,0.18)}
.go{
  background:linear-gradient(90deg,#2d72ff,#478bff);
  border:none;
  color:#fff;
  padding:10px 18px;
  border-radius:10px;
  font-weight:600;
  cursor:pointer;
  transition:all .3s ease;
}
.go:hover{background:linear-gradient(90deg,#5593ff,#78b2ff);transform:translateY(-1px)}
.go:active{transform:scale(0.97)}

/* --- Hero text fade-in --- */

.hero-text {
  display: flex;
  flex-direction: column;
  align-items: center;  /* horizontal centering */
  text-align: center;   /* text itself centered */
  gap: 8px;             /* spacing between title and description */
}

.hero h1, .hero p {
  opacity: 0;
  transform: translateY(15px);
  transition: opacity 0.8s ease, transform 0.8s ease;
}
.hero.fade-in h1, .hero.fade-in p {
  opacity: 1;
  transform: translateY(0);
}

.footer{text-align:center;padding:8px;margin:10px;font-size:15px;color:#9fb6df;background:linear-gradient(180deg,rgba(8,17,41,0.95),rgba(6,10,28,0.95));border-top:1px solid rgba(255,255,255,0.06)}

@media(max-width:1100px){
  .container{grid-template-columns:1fr;gap:24px}
  .center{order:-1;margin-bottom:16px}
  .hero{width:100%;min-height:580px}
  #map-card{height:400px}
}
@media(max-width:600px){
  body{padding:12px}
  .hero{padding:16px;min-height:520px;border-radius:20px}
  .temp{font-size:56px}
}
/* --- Responsive adjustments --- */
@media(max-width:1100px){
  .container {
    display: flex;
    flex-direction: column;
    gap: 16px;
  }
  .center { order: -1; margin-bottom: 16px; }
  .hero { width: 100%; min-height: 580px; order: -1; }
  #map-card { height: 400px; }
  .left, .right { width: 100%; }
}

@media(max-width:600px){
  body { padding: 12px; }
  .hero { padding: 16px; min-height: 520px; border-radius: 20px; }
  .temp { font-size: 56px; }
  .search-row input { font-size: 16px; }
  .go { font-size: 16px; padding: 12px 18px; }
}

</style>
</head>
<body>
<div class="container">
  <div class="left">
    <div class="card large">
      <div>
        <div class="top">
          <div>
            <div class="temp" id="left-temp">--¬∞</div>
            <div class="subtitle" id="left-cond">--</div>
            <div class="muted" id="left-date">--</div>
          </div>
          <div class="icon-big" id="left-icon">‚òÅÔ∏è</div>
        </div>
        <div class="meta-row">
          <div class="meta-item"><div class="muted">Wind</div><div id="left-wind">-- m/s</div></div>
          <div class="meta-item"><div class="muted">Humidity</div><div id="left-hum">--%</div></div>
          <div class="meta-item"><div class="muted">Rain</div><div id="left-rain">--</div></div>
        </div>
        <div class="forecast-container" id="hourly-forecast"></div>
        <div class="forecast-container" id="daily-forecast"></div>
      </div>
    </div>
  </div>

 <div class="hero card">
  <div class="sky">
    <div class="cloud" id="hero-cloud">
      <div class="drop"></div><div class="drop"></div><div class="drop"></div>
    </div>
  </div>

  <!-- Text wrapper for perfect centering -->
  <div class="hero-text">
    <h1>Daily<br/>Weather</h1>
    <p>Our App Will Accurately Display Current Weather Conditions in No Time.</p>
  </div>

  <div style="width:100%">
    <div class="search-row" style="width:100%;display:flex;gap:8px;margin-top:12px">
      <input id="city-input" placeholder="Enter your location" aria-label="City name" />
      <button class="go" id="btn-search">Search</button>
    </div>
    <div id="status" class="centered muted" style="margin-top:10px;min-height:20px"></div>
  </div>
</div>


  <div class="right">
    <div class="card" id="map-card">
      <div id="map" style="width:100%;height:100%;border-radius:20px;"></div>
    </div>
  </div>
</div>

<footer class="footer">
  <p>¬© 2025 Daily Weather. All Rights Reserved.</p>
</footer>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script src="config.js"></script>
<script>
const statusEl=document.getElementById('status');
function setStatus(msg,isError=false){statusEl.textContent=msg||'';statusEl.style.color=isError?'#ffb4b4':'';}
function capitalize(s){return s?s.split(' ').map(p=>p.charAt(0).toUpperCase()+p.slice(1)).join(' '):'';}
function iconFromWeather(iconCode){
 if(!iconCode)return'‚òÅÔ∏è';
 const code=iconCode.slice(0,2);
 switch(code){case'01':return'‚òÄÔ∏è';case'02':return'‚õÖ';case'03':case'04':return'‚òÅÔ∏è';
 case'09':return'üåßÔ∏è';case'10':return'üå¶Ô∏è';case'11':return'‚õàÔ∏è';case'13':return'‚ùÑÔ∏è';case'50':return'üå´Ô∏è';default:return'‚òÅÔ∏è';}
}
let liveTimeInterval=null;
function renderMain(data){
 const tempC=Math.round(data.main.temp);
 document.getElementById('left-temp').textContent=tempC+'¬∞';
 document.getElementById('left-cond').textContent=capitalize(data.weather[0].main)+' ‚Äî '+capitalize(data.weather[0].description);
 document.getElementById('left-wind').textContent=Math.round(data.wind.speed)+' m/s';
 document.getElementById('left-hum').textContent=data.main.humidity+'%';
 const rainVal=(data.rain&&(data.rain['1h']||data.rain['3h']))?(data.rain['1h']||data.rain['3h'])+' mm':'0 mm';
 document.getElementById('left-rain').textContent=rainVal;
 document.getElementById('left-icon').textContent=iconFromWeather(data.weather[0].icon);
 document.getElementById('hero-cloud').style.opacity=data.weather[0].main.toLowerCase().includes('rain')?'1':'0.8';
 if(data.coord&&data.name)updateMap(data.coord.lat,data.coord.lon,data.name);

 const leftDateEl=document.getElementById('left-date');
 if(leftDateEl){
   if(liveTimeInterval)clearInterval(liveTimeInterval);
   function updateTime(){
     const nowUTC=Date.now();
     const localTime=new Date(nowUTC+data.timezone*1000);
     leftDateEl.textContent=localTime.toISOString().replace('T',' ').split('.')[0];
   }
   updateTime();
   liveTimeInterval=setInterval(updateTime,1000);
 }
}
async function fetchJSON(url){
 const res=await fetch(url);
 if(!res.ok)throw new Error(await res.text()||'API error');
 return res.json();
}
async function fetchForecast(lat,lon){
 const url=`https://api.openweathermap.org/data/2.5/forecast?lat=${lat}&lon=${lon}&units=metric&appid=${API_KEY}`;
 try{const data=await fetchJSON(url);renderForecasts(data);}catch(err){console.error(err);}
}
function renderForecasts(data){
 const hourlyContainer=document.getElementById('hourly-forecast');
 const dailyContainer=document.getElementById('daily-forecast');
 hourlyContainer.innerHTML='<h3 style="width:100%;font-size:15px;margin-bottom:6px;color:#9fb6df">Hourly Forecast</h3>';
 dailyContainer.innerHTML='<h3 style="width:100%;font-size:15px;margin-bottom:6px;color:#9fb6df">5-Day Forecast</h3>';
 data.list.slice(0,6).forEach(item=>{
   const time=new Date(item.dt*1000).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});
   const el=document.createElement('div');
   el.className='forecast-card';
   el.innerHTML=`<h4>${time}</h4><span>${Math.round(item.main.temp)}¬∞C</span><span>${iconFromWeather(item.weather[0].icon)}</span>`;
   hourlyContainer.appendChild(el);
 });
 const days={};
 data.list.forEach(item=>{
   const date=new Date(item.dt*1000);
   const day=date.toLocaleDateString([], {weekday:'short'});
   const hour=date.getHours();
   if(!days[day] || Math.abs(hour-12)<Math.abs(new Date(days[day].dt*1000).getHours()-12)){
     days[day]=item;
   }
 });
 Object.keys(days).slice(0,5).forEach(day=>{
   const item=days[day];
   const el=document.createElement('div');
   el.className='forecast-card';
   el.innerHTML=`<h4>${day}</h4><span>${Math.round(item.main.temp)}¬∞C</span><span>${iconFromWeather(item.weather[0].icon)}</span>`;
   dailyContainer.appendChild(el);
 });
}
async function fetchByCity(city){
 if(!API_KEY){setStatus('Missing API key.',true);return;}
 setStatus('Loading weather for '+city+' ...');
 const q=encodeURIComponent(city);
 const url=`https://api.openweathermap.org/data/2.5/weather?q=${q}&units=metric&appid=${API_KEY}`;
 try{
   const data=await fetchJSON(url);
   renderMain(data);
   fetchForecast(data.coord.lat,data.coord.lon);
   setStatus('');
 }catch(err){console.error(err);setStatus('Could not load weather: '+(err.message||err),true);}
}
const map=L.map('map',{zoomControl:true}).setView([0,0],2);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{maxZoom:19,attribution:'&copy; OpenStreetMap contributors'}).addTo(map);
let marker=null;
function updateMap(lat,lon,cityName){
 map.setView([lat,lon],10);
 if(marker)map.removeLayer(marker);
 marker=L.marker([lat,lon]).addTo(map).bindPopup(cityName).openPopup();
}
function resizeMap(){
 const mapCard=document.getElementById('map-card');
 mapCard.style.height=window.innerWidth<1100?'400px':'480px';
 map.invalidateSize();
}
window.addEventListener('resize',resizeMap);
document.getElementById('btn-search').addEventListener('click',()=>{
 const city=document.getElementById('city-input').value.trim();
 if(!city){setStatus('Please type a city name',true);return;}
 fetchByCity(city);
});
document.getElementById('city-input').addEventListener('keydown',e=>{
 if(e.key==='Enter')document.getElementById('btn-search').click();
});

// --- Hero text fade-in ---
window.addEventListener('load',()=>{
 resizeMap();
 fetchByCity('Colombo,Sri Lanka');
 setTimeout(()=>{
   document.querySelector('.hero').classList.add('fade-in');
 },200);
});
</script>
</body>
</html>